INFO:root:Namespace(model_name='BPR')
INFO:root:--------------------------------------------- BEGIN: 2020-06-27 15:27:08 ---------------------------------------------
INFO:root:
========================================
 Arguments       | Values               
========================================
 batch_size      | 256                 
 buffer          | 1                   
 dataset         | Grocery_and_Gourm...
 dropout         | 0.2                 
 early_stop      | 5                   
 emb_size        | 64                  
 epoch           | 100                 
 eval_batch_size | 256                 
 gpu             | 0                   
 history_max     | 20                  
 l2              | 1e-06               
 load            | 0                   
 lr              | 0.001               
 metric          | ["NDCG","HR"]       
 num_neg         | 1                   
 num_workers     | 5                   
 optimizer       | Adam                
 random_seed     | 2019                
 topk            | [5,10]              
========================================
INFO:root:# cuda devices: 1
INFO:root:Reading data from "../data/", dataset = "Grocery_and_Gourmet_Food" 
INFO:root:Formating data type...
INFO:root:Constructing relation triplets...
INFO:root:Counting dataset statistics...
INFO:root:"# user": 14681, "# item": 8457, "# entry": 145832
INFO:root:"# relation": 3, "# triplet": 372090
INFO:root:Adding history info...
INFO:root:Done! [9.00 s]

INFO:root:Save corpus to ../data/Grocery_and_Gourmet_Food/BaseReader.pkl
INFO:root:#params: 1503970
INFO:root:BPR(
  (u_embeddings): Embedding(14681, 64)
  (i_embeddings): Embedding(8457, 64)
  (user_bias): Embedding(14681, 1)
  (item_bias): Embedding(8457, 1)
)
INFO:root:Test Before Training: (HR@10:0.1086,HR@5:0.0571,NDCG@10:0.0495,NDCG@5:0.0330)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.6587 [1.7 s]	 dev=(HR@5:0.2827,NDCG@5:0.1845) test=(HR@5:0.2433,NDCG@5:0.1520) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 2     loss=0.5172 [1.7 s]	 dev=(HR@5:0.2969,NDCG@5:0.1958) test=(HR@5:0.2610,NDCG@5:0.1648) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 3     loss=0.4448 [1.8 s]	 dev=(HR@5:0.3079,NDCG@5:0.2073) test=(HR@5:0.2663,NDCG@5:0.1725) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 4     loss=0.4009 [2.0 s]	 dev=(HR@5:0.3209,NDCG@5:0.2194) test=(HR@5:0.2713,NDCG@5:0.1798) [0.8 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 5     loss=0.3598 [1.9 s]	 dev=(HR@5:0.3268,NDCG@5:0.2258) test=(HR@5:0.2783,NDCG@5:0.1859) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 6     loss=0.3219 [1.8 s]	 dev=(HR@5:0.3370,NDCG@5:0.2338) test=(HR@5:0.2865,NDCG@5:0.1937) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 7     loss=0.2868 [1.8 s]	 dev=(HR@5:0.3462,NDCG@5:0.2412) test=(HR@5:0.2928,NDCG@5:0.1992) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 8     loss=0.2529 [1.7 s]	 dev=(HR@5:0.3552,NDCG@5:0.2484) test=(HR@5:0.2993,NDCG@5:0.2037) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 9     loss=0.2220 [1.9 s]	 dev=(HR@5:0.3606,NDCG@5:0.2543) test=(HR@5:0.3055,NDCG@5:0.2068) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 10    loss=0.1966 [1.8 s]	 dev=(HR@5:0.3668,NDCG@5:0.2582) test=(HR@5:0.3075,NDCG@5:0.2100) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 11    loss=0.1724 [1.7 s]	 dev=(HR@5:0.3738,NDCG@5:0.2646) test=(HR@5:0.3134,NDCG@5:0.2138) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 12    loss=0.1524 [1.8 s]	 dev=(HR@5:0.3781,NDCG@5:0.2664) test=(HR@5:0.3171,NDCG@5:0.2162) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 13    loss=0.1346 [1.7 s]	 dev=(HR@5:0.3794,NDCG@5:0.2677) test=(HR@5:0.3197,NDCG@5:0.2179) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 14    loss=0.1197 [1.8 s]	 dev=(HR@5:0.3832,NDCG@5:0.2709) test=(HR@5:0.3223,NDCG@5:0.2210) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 15    loss=0.1067 [1.9 s]	 dev=(HR@5:0.3842,NDCG@5:0.2722) test=(HR@5:0.3237,NDCG@5:0.2221) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 16    loss=0.0965 [1.7 s]	 dev=(HR@5:0.3860,NDCG@5:0.2738) test=(HR@5:0.3242,NDCG@5:0.2225) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 17    loss=0.0866 [1.8 s]	 dev=(HR@5:0.3886,NDCG@5:0.2761) test=(HR@5:0.3264,NDCG@5:0.2238) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 18    loss=0.0783 [1.7 s]	 dev=(HR@5:0.3917,NDCG@5:0.2779) test=(HR@5:0.3281,NDCG@5:0.2250) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 19    loss=0.0723 [1.9 s]	 dev=(HR@5:0.3917,NDCG@5:0.2780) test=(HR@5:0.3295,NDCG@5:0.2267) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 20    loss=0.0658 [1.9 s]	 dev=(HR@5:0.3925,NDCG@5:0.2794) test=(HR@5:0.3308,NDCG@5:0.2273) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 21    loss=0.0613 [1.6 s]	 dev=(HR@5:0.3933,NDCG@5:0.2804) test=(HR@5:0.3304,NDCG@5:0.2275) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 22    loss=0.0570 [1.8 s]	 dev=(HR@5:0.3954,NDCG@5:0.2824) test=(HR@5:0.3322,NDCG@5:0.2294) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 23    loss=0.0530 [1.6 s]	 dev=(HR@5:0.3965,NDCG@5:0.2831) test=(HR@5:0.3322,NDCG@5:0.2285) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 24    loss=0.0506 [1.8 s]	 dev=(HR@5:0.3974,NDCG@5:0.2833) test=(HR@5:0.3335,NDCG@5:0.2295) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 25    loss=0.0481 [1.9 s]	 dev=(HR@5:0.3993,NDCG@5:0.2849) test=(HR@5:0.3369,NDCG@5:0.2306) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 26    loss=0.0455 [1.8 s]	 dev=(HR@5:0.4014,NDCG@5:0.2863) test=(HR@5:0.3380,NDCG@5:0.2327) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 27    loss=0.0436 [1.7 s]	 dev=(HR@5:0.4023,NDCG@5:0.2874) test=(HR@5:0.3393,NDCG@5:0.2328) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 28    loss=0.0414 [1.6 s]	 dev=(HR@5:0.4031,NDCG@5:0.2879) test=(HR@5:0.3367,NDCG@5:0.2315) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 29    loss=0.0400 [1.8 s]	 dev=(HR@5:0.4021,NDCG@5:0.2875) test=(HR@5:0.3380,NDCG@5:0.2320) [0.6 s] 
INFO:root:Epoch 30    loss=0.0399 [1.8 s]	 dev=(HR@5:0.4029,NDCG@5:0.2881) test=(HR@5:0.3382,NDCG@5:0.2324) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 31    loss=0.0375 [1.7 s]	 dev=(HR@5:0.4053,NDCG@5:0.2902) test=(HR@5:0.3371,NDCG@5:0.2316) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 32    loss=0.0368 [2.1 s]	 dev=(HR@5:0.4049,NDCG@5:0.2900) test=(HR@5:0.3408,NDCG@5:0.2340) [0.7 s] 
INFO:root:Epoch 33    loss=0.0368 [1.9 s]	 dev=(HR@5:0.4067,NDCG@5:0.2914) test=(HR@5:0.3414,NDCG@5:0.2354) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 34    loss=0.0354 [1.7 s]	 dev=(HR@5:0.4073,NDCG@5:0.2919) test=(HR@5:0.3419,NDCG@5:0.2356) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 35    loss=0.0353 [1.7 s]	 dev=(HR@5:0.4081,NDCG@5:0.2928) test=(HR@5:0.3431,NDCG@5:0.2366) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 36    loss=0.0345 [1.8 s]	 dev=(HR@5:0.4092,NDCG@5:0.2934) test=(HR@5:0.3441,NDCG@5:0.2361) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 37    loss=0.0339 [1.8 s]	 dev=(HR@5:0.4095,NDCG@5:0.2934) test=(HR@5:0.3455,NDCG@5:0.2379) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 38    loss=0.0335 [1.8 s]	 dev=(HR@5:0.4100,NDCG@5:0.2940) test=(HR@5:0.3463,NDCG@5:0.2379) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 39    loss=0.0330 [1.8 s]	 dev=(HR@5:0.4112,NDCG@5:0.2952) test=(HR@5:0.3476,NDCG@5:0.2398) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 40    loss=0.0333 [1.8 s]	 dev=(HR@5:0.4111,NDCG@5:0.2950) test=(HR@5:0.3483,NDCG@5:0.2400) [0.7 s] 
INFO:root:Epoch 41    loss=0.0320 [1.8 s]	 dev=(HR@5:0.4117,NDCG@5:0.2958) test=(HR@5:0.3476,NDCG@5:0.2396) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 42    loss=0.0318 [1.8 s]	 dev=(HR@5:0.4115,NDCG@5:0.2956) test=(HR@5:0.3476,NDCG@5:0.2399) [0.6 s] 
INFO:root:Epoch 43    loss=0.0315 [1.8 s]	 dev=(HR@5:0.4133,NDCG@5:0.2975) test=(HR@5:0.3478,NDCG@5:0.2405) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 44    loss=0.0314 [1.7 s]	 dev=(HR@5:0.4149,NDCG@5:0.2981) test=(HR@5:0.3485,NDCG@5:0.2412) [0.7 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 45    loss=0.0307 [1.8 s]	 dev=(HR@5:0.4141,NDCG@5:0.2984) test=(HR@5:0.3490,NDCG@5:0.2410) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 46    loss=0.0311 [1.7 s]	 dev=(HR@5:0.4142,NDCG@5:0.2981) test=(HR@5:0.3495,NDCG@5:0.2411) [0.6 s] 
INFO:root:Epoch 47    loss=0.0310 [1.8 s]	 dev=(HR@5:0.4171,NDCG@5:0.2996) test=(HR@5:0.3516,NDCG@5:0.2423) [0.6 s] 
INFO:root:Save model to ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__...
INFO:root:Epoch 48    loss=0.0299 [1.9 s]	 dev=(HR@5:0.4156,NDCG@5:0.2994) test=(HR@5:0.3506,NDCG@5:0.2421) [0.6 s] 
INFO:root:Epoch 49    loss=0.0304 [1.6 s]	 dev=(HR@5:0.4159,NDCG@5:0.2992) test=(HR@5:0.3517,NDCG@5:0.2433) [0.6 s] 
INFO:root:Epoch 50    loss=0.0300 [1.8 s]	 dev=(HR@5:0.4148,NDCG@5:0.2987) test=(HR@5:0.3517,NDCG@5:0.2420) [0.6 s] 
INFO:root:Epoch 51    loss=0.0299 [1.7 s]	 dev=(HR@5:0.4132,NDCG@5:0.2982) test=(HR@5:0.3530,NDCG@5:0.2433) [0.6 s] 
INFO:root:Early stop at 51 based on dev result.
INFO:root:
Best Iter(dev)=   47	 dev=(HR@5:0.4171,NDCG@5:0.2996) test=(HR@5:0.3516,NDCG@5:0.2423) [123.3 s] 
INFO:root:Load model from ../model/BPR/BPR__Grocery_and_Gourmet_Food__2019__lr=0.001__l2=1e-06.pt
INFO:root:
Test After Training: (HR@10:0.4597,HR@5:0.3516,NDCG@10:0.2775,NDCG@5:0.2423)
INFO:root:
--------------------------------------------- END: 2020-06-27 15:29:25 ---------------------------------------------
